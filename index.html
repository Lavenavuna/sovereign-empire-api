<!-- ORDER FORM -->
<section id="order" class="container">
    <h2 style="text-align: center; margin-bottom: 40px;">Ready to Get Started?</h2>
    
    <form id="orderForm" style="max-width: 600px; margin: 0 auto; background: #f8f9fa; padding: 40px; border-radius: 12px;">
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Business Name</label>
            <input type="text" id="customer_name" name="customer_name" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Email</label>
            <input type="email" id="customer_email" name="customer_email" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Business Type (e.g., Dental Practice, Cleaning Service)</label>
            <input type="text" id="industry" name="industry" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Primary Service You Want to Rank For</label>
            <input type="text" id="topic" name="topic" placeholder="e.g., Dental Implants in Suva" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Website URL (if you have one)</label>
            <input type="url" id="wordpress_url" name="wordpress_url" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px;">
        </div>
        
        <div id="message" style="margin-bottom: 20px; padding: 15px; border-radius: 6px; display: none;"></div>
        
        <button type="submit" id="submitBtn" style="width: 100%; background: #667eea; color: white; padding: 16px; border: none; border-radius: 6px; font-size: 18px; font-weight: 600; cursor: pointer;">
            Start My 30-Day Kickstart - $149
        </button>
    </form>
</section>

<script>
document.getElementById('orderForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const messageDiv = document.getElementById('message');
    
    // Disable button and show loading
    submitBtn.disabled = true;
    submitBtn.textContent = 'Processing...';
    messageDiv.style.display = 'none';
    
    // Get form data
    const data = {
        customer_name: document.getElementById('customer_name').value,
        customer_email: document.getElementById('customer_email').value,
        industry: document.getElementById('industry').value,
        topic: document.getElementById('topic').value,
        wordpress_url: document.getElementById('wordpress_url').value || '',
        tenant_id: "DIRECT_CUSTOMER"
    };
    
    try {
        const response = await fetch('https://sovereign-empire-api-production.up.railway.app/api/orders/create', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });
        
        // Check if request was successful (even if API returns error, order might be created)
        if (response.status === 200 || response.status === 201) {
            try {
                const result = await response.json();
                
                // Success
                messageDiv.style.display = 'block';
                messageDiv.style.background = '#d4edda';
                messageDiv.style.color = '#155724';
                messageDiv.style.border = '1px solid #c3e6cb';
                messageDiv.innerHTML = `
                    <strong>✅ Order Received!</strong><br><br>
                    <strong>What happens next:</strong><br>
                    1. Check your email (${data.customer_email}) for payment instructions<br>
                    2. Pay via PayPal to confirm your order<br>
                    3. We'll start your 30-Day Google Visibility Kickstart immediately<br><br>
                    <strong>Questions?</strong> Reply to the confirmation email.
                `;
                
                // Reset form
                document.getElementById('orderForm').reset();
                
                // Scroll to message
                messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
            } catch (jsonError) {
                // Response wasn't JSON, but order was likely created
                messageDiv.style.display = 'block';
                messageDiv.style.background = '#d4edda';
                messageDiv.style.color = '#155724';
                messageDiv.style.border = '1px solid #c3e6cb';
                messageDiv.innerHTML = `
                    <strong>✅ Order Received!</strong><br><br>
                    <strong>What happens next:</strong><br>
                    1. Check your email (${data.customer_email}) for payment instructions<br>
                    2. Pay via PayPal to confirm your order<br>
                    3. We'll start your 30-Day Google Visibility Kickstart immediately<br><br>
                    <strong>Questions?</strong> Reply to the confirmation email.
                `;
                
                // Reset form
                document.getElementById('orderForm').reset();
                
                // Scroll to message
                messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            
        } else {
            // Error response
            const errorText = await response.text();
            throw new Error('Submission failed. Please try again or contact us directly.');
        }
        
    } catch (error) {
        messageDiv.style.display = 'block';
        messageDiv.style.background = '#f8d7da';
        messageDiv.style.color = '#721c24';
        messageDiv.style.border = '1px solid #f5c6cb';
        messageDiv.innerHTML = `
            <strong>❌ Submission Error</strong><br><br>
            There was a problem submitting your order.<br><br>
            <strong>Please email us directly:</strong><br>
            <a href="mailto:sretonia@gmail.com?subject=Order%20Request&body=Business%20Name:%20${encodeURIComponent(data.customer_name)}%0AEmail:%20${encodeURIComponent(data.customer_email)}%0ABusiness%20Type:%20${encodeURIComponent(data.industry)}%0AService:%20${encodeURIComponent(data.topic)}%0AWebsite:%20${encodeURIComponent(data.wordpress_url)}" style="color: #721c24; font-weight: bold;">sretonia@gmail.com</a><br><br>
            Or call: [Your Phone Number]
        `;
        
        // Scroll to error message
        messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    } finally {
        // Re-enable button
        submitBtn.disabled = false;
        submitBtn.textContent = 'Start My 30-Day Kickstart - $149';
    }
});
</script>
